"use strict";(()=>{var e={};e.id=843,e.ids=[843],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1017:e=>{e.exports=require("path")},4043:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>v,originalPathname:()=>P,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>_,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>x});var a={};t.r(a),t.d(a,{POST:()=>POST,runtime:()=>f});var s=t(884),o=t(6132),n=t(5798);let i=require("fs");var u=t.n(i),l=t(1017),p=t.n(l);let c=require("os");var d=t.n(c);function parseDataURI(e){try{let r=e.match(/^data:(.+);(base64),(.+)$/);if(!r||r.length<4)throw Error("無効なData URI形式です");let t=r[1],a=r[3],s=Buffer.from(a,"base64");return{buffer:s,mimeType:t}}catch(e){throw console.error("Data URIのパースに失敗:",e.message),Error("無効なData URI")}}let f="nodejs";async function POST(e){try{let r=await e.json(),{screenshots:t}=r;if(!t||!Array.isArray(t))return n.Z.json({status:"error",message:'無効なペイロードです。"screenshots" 配列が見つかりません。'},{status:400});console.log(`受信したスクリーンショット: ${t.length}件`);let a=[];for(let e of t){let{filename:r,data:t}=e,{buffer:s}=parseDataURI(t),o=d().tmpdir(),n=p().join(o,r);u().writeFileSync(n,s),a.push({filename:r,size:s.length}),console.log(`一時ファイルとして保存完了: ${n}`)}return n.Z.json({status:"success",message:`サーバー側で ${a.length}件 のファイルを受信・処理しました。`,processedFiles:a})}catch(e){return console.error("アップロード処理エラー:",e),n.Z.json({status:"error",message:`サーバー内部エラー: ${e.message}`},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/diff/route",pathname:"/api/diff",filename:"route",bundlePath:"app/api/diff/route"},resolvedPagePath:"C:\\Users\\ShirakamiCocoa\\Desktop\\processLog\\src\\app\\api\\diff\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:g,staticGenerationAsyncStorage:h,serverHooks:_,headerHooks:v,staticGenerationBailout:x}=m,P="/api/diff/route"}};var r=require("../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[997],()=>__webpack_exec__(4043));module.exports=t})();